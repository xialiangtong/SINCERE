<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>ProductShipmentOOP.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">sincere</a> &gt; <a href="index.source.html" class="el_package">default</a> &gt; <span class="el_source">ProductShipmentOOP.java</span></div><h1>ProductShipmentOOP.java</h1><pre class="source lang-java linenums">import java.util.*;

/**
 * OOP-style Product Shipment Solution
 * 
 * This solution provides better extensibility through object-oriented design,
 * allowing for easy addition of product attributes, dependency rules, and shipping logic.
 */
<span class="nc" id="L9">public class ProductShipmentOOP {</span>

    /**
     * Represents a product in the catalog.
     */
    public static class Product {
        private final int id;
        private final String name;

<span class="nc" id="L18">        public Product(int id) {</span>
<span class="nc" id="L19">            this.id = id;</span>
<span class="nc" id="L20">            this.name = &quot;Product-&quot; + id;</span>
<span class="nc" id="L21">        }</span>

<span class="nc" id="L23">        public Product(int id, String name) {</span>
<span class="nc" id="L24">            this.id = id;</span>
<span class="nc" id="L25">            this.name = name;</span>
<span class="nc" id="L26">        }</span>

        public int getId() {
<span class="nc" id="L29">            return id;</span>
        }

        public String getName() {
<span class="nc" id="L33">            return name;</span>
        }

        @Override
        public boolean equals(Object o) {
<span class="nc bnc" id="L38" title="All 2 branches missed.">            if (this == o) return true;</span>
<span class="nc bnc" id="L39" title="All 4 branches missed.">            if (o == null || getClass() != o.getClass()) return false;</span>
<span class="nc" id="L40">            Product product = (Product) o;</span>
<span class="nc bnc" id="L41" title="All 2 branches missed.">            return id == product.id;</span>
        }

        @Override
        public int hashCode() {
<span class="nc" id="L46">            return Objects.hash(id);</span>
        }

        @Override
        public String toString() {
<span class="nc" id="L51">            return &quot;Product{id=&quot; + id + &quot;, name='&quot; + name + &quot;'}&quot;;</span>
        }
    }

    /**
     * Represents a dependency rule between two products.
     * Products linked by a dependency rule must be shipped together.
     */
    public static class DependencyRule {
        private final Product product1;
        private final Product product2;

<span class="nc" id="L63">        public DependencyRule(Product product1, Product product2) {</span>
<span class="nc" id="L64">            this.product1 = product1;</span>
<span class="nc" id="L65">            this.product2 = product2;</span>
<span class="nc" id="L66">        }</span>

        public Product getProduct1() {
<span class="nc" id="L69">            return product1;</span>
        }

        public Product getProduct2() {
<span class="nc" id="L73">            return product2;</span>
        }

        @Override
        public boolean equals(Object o) {
<span class="nc bnc" id="L78" title="All 2 branches missed.">            if (this == o) return true;</span>
<span class="nc bnc" id="L79" title="All 4 branches missed.">            if (o == null || getClass() != o.getClass()) return false;</span>
<span class="nc" id="L80">            DependencyRule that = (DependencyRule) o;</span>
            // A rule (A, B) is equal to (B, A) since it's undirected
<span class="nc bnc" id="L82" title="All 4 branches missed.">            return (Objects.equals(product1, that.product1) &amp;&amp; Objects.equals(product2, that.product2))</span>
<span class="nc bnc" id="L83" title="All 4 branches missed.">                    || (Objects.equals(product1, that.product2) &amp;&amp; Objects.equals(product2, that.product1));</span>
        }

        @Override
        public int hashCode() {
            // Use a symmetric hash so (A, B) and (B, A) have the same hash
<span class="nc" id="L89">            return Objects.hash(product1.getId()) + Objects.hash(product2.getId());</span>
        }

        @Override
        public String toString() {
<span class="nc" id="L94">            return &quot;DependencyRule{&quot; + product1 + &quot; &lt;-&gt; &quot; + product2 + &quot;}&quot;;</span>
        }
    }

    /**
     * Represents a group of products that must be shipped together.
     */
    public static class ShippingGroup {
        private final Set&lt;Product&gt; products;

<span class="nc" id="L104">        public ShippingGroup() {</span>
<span class="nc" id="L105">            this.products = new LinkedHashSet&lt;&gt;();</span>
<span class="nc" id="L106">        }</span>

        public void addProduct(Product product) {
<span class="nc" id="L109">            products.add(product);</span>
<span class="nc" id="L110">        }</span>

        public Set&lt;Product&gt; getProducts() {
<span class="nc" id="L113">            return Collections.unmodifiableSet(products);</span>
        }

        public int size() {
<span class="nc" id="L117">            return products.size();</span>
        }

        public boolean contains(Product product) {
<span class="nc" id="L121">            return products.contains(product);</span>
        }

        @Override
        public String toString() {
<span class="nc" id="L126">            return &quot;ShippingGroup{products=&quot; + products + &quot;}&quot;;</span>
        }
    }

    /**
     * Manages the product catalog including products, dependency rules,
     * and provides methods to compute shipping groups.
     */
    public static class ProductCatalog {
        private final Map&lt;Integer, Product&gt; products;
        private final Set&lt;DependencyRule&gt; dependencyRules;
        private final Map&lt;Product, Set&lt;Product&gt;&gt; adjacencyList;

<span class="nc" id="L139">        public ProductCatalog() {</span>
<span class="nc" id="L140">            this.products = new LinkedHashMap&lt;&gt;();</span>
<span class="nc" id="L141">            this.dependencyRules = new LinkedHashSet&lt;&gt;();</span>
<span class="nc" id="L142">            this.adjacencyList = new HashMap&lt;&gt;();</span>
<span class="nc" id="L143">        }</span>

        /**
         * Adds a product to the catalog.
         */
        public void addProduct(Product product) {
<span class="nc" id="L149">            products.put(product.getId(), product);</span>
<span class="nc" id="L150">            adjacencyList.putIfAbsent(product, new HashSet&lt;&gt;());</span>
<span class="nc" id="L151">        }</span>

        /**
         * Adds multiple products to the catalog.
         */
        public void addProducts(Product... productsToAdd) {
<span class="nc bnc" id="L157" title="All 2 branches missed.">            for (Product product : productsToAdd) {</span>
<span class="nc" id="L158">                addProduct(product);</span>
            }
<span class="nc" id="L160">        }</span>

        /**
         * Adds a dependency rule between two products.
         * Both products must already exist in the catalog.
         */
        public void addDependencyRule(DependencyRule rule) {
<span class="nc" id="L167">            Product p1 = rule.getProduct1();</span>
<span class="nc" id="L168">            Product p2 = rule.getProduct2();</span>

            // Ensure both products are in the catalog
<span class="nc bnc" id="L171" title="All 2 branches missed.">            if (!products.containsKey(p1.getId())) {</span>
<span class="nc" id="L172">                addProduct(p1);</span>
            }
<span class="nc bnc" id="L174" title="All 2 branches missed.">            if (!products.containsKey(p2.getId())) {</span>
<span class="nc" id="L175">                addProduct(p2);</span>
            }

<span class="nc" id="L178">            dependencyRules.add(rule);</span>

            // Update adjacency list (undirected graph)
<span class="nc" id="L181">            adjacencyList.get(p1).add(p2);</span>
<span class="nc" id="L182">            adjacencyList.get(p2).add(p1);</span>
<span class="nc" id="L183">        }</span>

        /**
         * Adds a dependency rule between two products by their IDs.
         */
        public void addDependencyRule(int productId1, int productId2) {
<span class="nc" id="L189">            Product p1 = products.get(productId1);</span>
<span class="nc" id="L190">            Product p2 = products.get(productId2);</span>
<span class="nc bnc" id="L191" title="All 4 branches missed.">            if (p1 != null &amp;&amp; p2 != null) {</span>
<span class="nc" id="L192">                addDependencyRule(new DependencyRule(p1, p2));</span>
            }
<span class="nc" id="L194">        }</span>

        /**
         * Gets a product by its ID.
         */
        public Product getProduct(int id) {
<span class="nc" id="L200">            return products.get(id);</span>
        }

        /**
         * Gets all products in the catalog.
         */
        public Collection&lt;Product&gt; getAllProducts() {
<span class="nc" id="L207">            return Collections.unmodifiableCollection(products.values());</span>
        }

        /**
         * Gets all dependency rules.
         */
        public Set&lt;DependencyRule&gt; getDependencyRules() {
<span class="nc" id="L214">            return Collections.unmodifiableSet(dependencyRules);</span>
        }

        /**
         * Computes shipping groups using BFS to find connected components.
         * @return List of shipping groups
         */
        public List&lt;ShippingGroup&gt; getShippingGroups() {
<span class="nc" id="L222">            List&lt;ShippingGroup&gt; groups = new ArrayList&lt;&gt;();</span>
<span class="nc" id="L223">            Set&lt;Product&gt; visited = new HashSet&lt;&gt;();</span>

<span class="nc bnc" id="L225" title="All 2 branches missed.">            for (Product product : products.values()) {</span>
<span class="nc bnc" id="L226" title="All 2 branches missed.">                if (!visited.contains(product)) {</span>
<span class="nc" id="L227">                    ShippingGroup group = new ShippingGroup();</span>
<span class="nc" id="L228">                    bfs(product, visited, group);</span>
<span class="nc" id="L229">                    groups.add(group);</span>
                }
<span class="nc" id="L231">            }</span>

<span class="nc" id="L233">            return groups;</span>
        }

        private void bfs(Product start, Set&lt;Product&gt; visited, ShippingGroup group) {
<span class="nc" id="L237">            Queue&lt;Product&gt; queue = new LinkedList&lt;&gt;();</span>
<span class="nc" id="L238">            queue.add(start);</span>
<span class="nc" id="L239">            visited.add(start);</span>

<span class="nc bnc" id="L241" title="All 2 branches missed.">            while (!queue.isEmpty()) {</span>
<span class="nc" id="L242">                Product current = queue.poll();</span>
<span class="nc" id="L243">                group.addProduct(current);</span>

<span class="nc bnc" id="L245" title="All 2 branches missed.">                for (Product neighbor : adjacencyList.getOrDefault(current, Collections.emptySet())) {</span>
<span class="nc bnc" id="L246" title="All 2 branches missed.">                    if (!visited.contains(neighbor)) {</span>
<span class="nc" id="L247">                        visited.add(neighbor);</span>
<span class="nc" id="L248">                        queue.add(neighbor);</span>
                    }
<span class="nc" id="L250">                }</span>
<span class="nc" id="L251">            }</span>
<span class="nc" id="L252">        }</span>

        /**
         * Gets the minimum number of shipments needed.
         */
        public int getMinimumShipments() {
<span class="nc" id="L258">            return getShippingGroups().size();</span>
        }

        @Override
        public String toString() {
<span class="nc" id="L263">            return &quot;ProductCatalog{products=&quot; + products.size() + </span>
<span class="nc" id="L264">                   &quot;, rules=&quot; + dependencyRules.size() + &quot;}&quot;;</span>
        }
    }

    public static void main(String[] args) {
        // Example usage with ProductCatalog
<span class="nc" id="L270">        ProductCatalog catalog = new ProductCatalog();</span>

        // Add products
<span class="nc" id="L273">        Product p0 = new Product(0, &quot;Laptop&quot;);</span>
<span class="nc" id="L274">        Product p1 = new Product(1, &quot;Charger&quot;);</span>
<span class="nc" id="L275">        Product p2 = new Product(2, &quot;Mouse&quot;);</span>
<span class="nc" id="L276">        Product p3 = new Product(3, &quot;Keyboard&quot;);</span>
<span class="nc" id="L277">        Product p4 = new Product(4, &quot;Monitor&quot;);</span>
        
<span class="nc" id="L279">        catalog.addProducts(p0, p1, p2, p3, p4);</span>

        // Add dependency rules
<span class="nc" id="L282">        catalog.addDependencyRule(new DependencyRule(p0, p1)); // Laptop must ship with Charger</span>
<span class="nc" id="L283">        catalog.addDependencyRule(new DependencyRule(p1, p2)); // Charger must ship with Mouse</span>
<span class="nc" id="L284">        catalog.addDependencyRule(new DependencyRule(p3, p4)); // Keyboard must ship with Monitor</span>

<span class="nc" id="L286">        System.out.println(&quot;Catalog: &quot; + catalog);</span>
<span class="nc" id="L287">        System.out.println(&quot;All Products: &quot; + catalog.getAllProducts());</span>
<span class="nc" id="L288">        System.out.println(&quot;Dependency Rules: &quot; + catalog.getDependencyRules());</span>
<span class="nc" id="L289">        System.out.println();</span>

        // Get shipping groups
<span class="nc" id="L292">        List&lt;ShippingGroup&gt; groups = catalog.getShippingGroups();</span>
<span class="nc" id="L293">        System.out.println(&quot;Shipping Groups (&quot; + groups.size() + &quot; shipments needed):&quot;);</span>
<span class="nc bnc" id="L294" title="All 2 branches missed.">        for (int i = 0; i &lt; groups.size(); i++) {</span>
<span class="nc" id="L295">            System.out.println(&quot;  Shipment &quot; + (i + 1) + &quot;: &quot; + groups.get(i));</span>
        }
<span class="nc" id="L297">    }</span>
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.10.202304240956</span></div></body></html>